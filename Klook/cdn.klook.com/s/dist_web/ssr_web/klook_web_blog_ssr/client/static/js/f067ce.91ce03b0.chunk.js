(window.webpackJsonp=window.webpackJsonp||[]).push([["f067ce"],{"3z4jSo":function(t,e,o){},"7xKVaS":function(t,e,o){"use strict";o("3z4jSo")},CjO8QH:function(t,e,o){"use strict";o("tRHt7y")},TNG9Jd:function(t,e,o){},hBdr71:function(t,e,o){"use strict";o("TNG9Jd")},kwatmN:function(t,e,o){"use strict";o("qePVmd");var n={name:"DiscountShowMore",filters:{truncate:function(t,e){return t.length>e&&(t=t.substring(0,e-8)+"... ".concat(this.moreText)),t}},props:{content:{require:!0,type:String,default:""},isMobile:{type:Boolean,default:!0},limit:{type:Number,default:40},height:{type:Number,default:0}},computed:{isTruncated:function(){return this.content.length>this.limit},truncatedText:function(){return this.isTruncated?this.content.substring(0,this.limit-8)+"... ".concat(this.moreText):this.content},moreText:function(){return this.$t("reviews.more_text")}}},s=o("KHd+Ze"),r=Object(s.a)(n,(function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{ref:"showMore",staticClass:"discount-show-more"},[t.isMobile?[o("div",{staticClass:"code-description",on:{click:function(e){t.isTruncated&&t.$emit("handle-click-more",t.content)}}},[t._v("\n      "+t._s(t.truncatedText)+"\n    ")])]:[t.isTruncated?o("klk-poptip",{attrs:{content:t.content,height:t.height,dark:""}},[o("div",{staticClass:"code-description"},[t._v(t._s(t.truncatedText))])]):o("div",{staticClass:"code-description"},[t._v("\n      "+t._s(t.truncatedText)+"\n    ")])]],2)}),[],!1,null,null,null);e.a=r.exports},pb33Ot:function(t,e,o){"use strict";o.r(e);o("07d7Qt"),o("SuFqDE");var n=o("lwsEjD"),s=o.n(n),r=o("W8MJtM"),c=o.n(r),a=o("7W2iVu"),i=o.n(a),u=o("a1gurj"),l=o.n(u),d=o("NsbkXA"),p=o.n(d),f=o("mrSGxO"),m=o("MmvrRj"),h=(o("qePVmd"),o("ma9Imd"),{50008:"campaign_not_yet_available",8002:"campaign_not_yet_available",50005:"campaign_already_redeemed",4001:"campaign_log_in_redeem",genericError:"campaign_code_no_available",success:"campaign_success_redeem",redeem:"campaign_redeem",redeemed:"campaign_redeemed",not_yet_available:"campaign_not_yet_available_ uppercase",no_longer_available:"campaign_no_available",campaign_promo_code:"campaign_promo _code"}),v=o("kwatmN"),g={name:"discount-card",components:{DiscountShowMore:v.a},props:{card:{type:Object,require:!0,default:function(){}},colorCategory:{type:String,default:"oringe"},colorType:{type:Number,default:0},isMobile:{type:Boolean,default:!1},inhouseBaseProperty:{type:Object,default:function(){return{}}}},data:function(){return{show:!1}},computed:{cardClass:function(){return"color-".concat(this.colorCategory,"-").concat(this.colorType)},campaignPromoText:function(){return this.$t(h.campaign_promo_code)},contentLimit:function(){return this.isLanguageCn?38:54}},methods:{showDetail:function(t){this.openDrawer=!0,this.detailContent=t}}},y=(o("7xKVaS"),o("KHd+Ze")),b=Object(y.a)(g,(function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{class:["discount-card",""+t.cardClass]},[o("div",{staticClass:"discount-item"},[o("div",{staticClass:"discount-left-outer",attrs:{"data-spm-item":"CouponInfo"}},[o("div",{staticClass:"discount-left"},[o("div",{staticClass:"discount-left-inner"},[o("div",{staticClass:"code-title"},[t._v(t._s(t.card.discount_desc))]),t._v(" "),o("discount-show-more",{attrs:{content:t.card.special_desc,limit:t.contentLimit,height:85,"is-mobile":!1}})],1)])]),t._v(" "),o("div",{staticClass:"discount-right",attrs:{"data-spm-item":"RedeemButton"}},[o("div",{staticClass:"discount-code-area"},[o("p",{staticClass:"discount-type"},[t._v(t._s(t.campaignPromoText))]),t._v(" "),o("span",{staticClass:"discount-code"},[t._v(t._s(t.card.code))])])])])])}),[],!1,null,null,null).exports,_=(o("pNMOM2"),o("TeQFY9"),o("5DmWYC"),o("FZtP4Z"),o("27RRn3"),o("lSNAPY")),k=o.n(_),C=o("yXPUfT"),O=o.n(C),P=o("o0o1eb"),j=o.n(P),w=(o("yq1kOy"),o("4mDm7A"),o("PKPkDs"),o("3bBZ2v"),o("mGGfxZ"),o("JTJg3T"),o("tktoO2"),o("J3vkrJ")),S=o("UGgtLY");function B(t,e){var o=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),o.push.apply(o,n)}return o}function R(t){for(var e=1;e<arguments.length;e++){var o=null!=arguments[e]?arguments[e]:{};e%2?B(Object(o),!0).forEach((function(e){k()(t,e,o[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(o)):B(Object(o)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(o,e))}))}return t}function T(t){var e=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var o,n=p()(t);if(e){var s=p()(this).constructor;o=Reflect.construct(n,arguments,s)}else o=n.apply(this,arguments);return l()(this,o)}}var x=Object(m.namespace)("auth"),M=Object(w.a)(),$={0:"87293",1:"campaign_redeemed",2:"87299"},N={TW:"APP10TW",KR:"KR10APP",IN:"IN10APP",TH:"TH10APP",ID:"ID05APP",PH:"PH05APP",MY:"MY05APP",VN:"VN05APP"},A=function(t){i()(o,t);var e=T(o);function o(){var t;return s()(this,o),(t=e.apply(this,arguments)).storageKey="KLOOK-BLOG-COUPON",t.couponTitle="87292",t.feedbackMessage="",t.showCard=!1,t.redeemStatus=0,t.card=null,t.visible=!1,t}return c()(o,[{key:"isLanguageCn",get:function(){return!!this.klook&&["zh-CN","zh-HK","zh-TW"].includes(this.klook.language)}},{key:"footerBtnByStatus",get:function(){return $[this.redeemStatus]}},{key:"isMobile",get:function(){return"mobile"===this.klook.platform}},{key:"couponCode",get:function(){return(null===N||void 0===N?void 0:N[this.klook.ipCountry])||"BETTERONAPP"}},{key:"codeRedeemSpm",get:function(){return 0===this.redeemStatus?"CodeRedemption":""}},{key:"handleLoginAndRedeem",value:function(){this.login("Blog")}},{key:"handleInited",value:function(){this.visible=!0}},{key:"closeByMobile",value:function(){this.$inhouse.track("custom","body",{spm:"BlogArticleCouponPopUp.CloseBtn"}),this.closeModal()}},{key:"closeModal",value:function(){this.visible=!1,[1,2].includes(this.redeemStatus)?M.setItem(this.storageKey,"close"):M.setItem(this.storageKey,"close",864e5)}},{key:"handleByStatus",value:function(){0===this.redeemStatus&&this.handleLoginAndRedeem(),[1,2].includes(this.redeemStatus)&&this.closeModal()}},{key:"redeem",value:function(){var t=O()(j.a.mark((function t(e){var o,n,s,r,c,a;return j.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return"/v1/couponapisrv/redeem",(o=new URLSearchParams).append("code",e),t.next=5,this.$axios.post("/v1/couponapisrv/redeem",o);case 5:n=t.sent,s=n.data,r=s.success,c=s.error,this.showCard=!1,r?(this.$inhouse.track("custom","body",{spm:"BlogArticleCodeRedemptionSuccess",object_id:"slug_".concat(this.slug)}),this.showCard=!1,this.couponTitle="87294",this.redeemStatus=1,this.feedbackMessage=this.$t("87295")):(this.$inhouse.track("custom","body",{spm:"BlogArticleCodeRedemptionFailure",object_id:"slug_".concat(this.slug)}),this.couponTitle="87297",this.redeemStatus=2,a=Object.keys(h).includes(c.code)?this.$t(h[c.code]):this.$t(h.genericError),"4001"===c.code?this.login("Blog"):"50005"===c.code?(this.feedbackMessage=a,this.card.redeemed=!0):(c.code,this.feedbackMessage=a,this.card.usable=!1));case 9:case"end":return t.stop()}}),t,this)})));return function(e){return t.apply(this,arguments)}}()},{key:"getDiscountCodesByCodes",value:function(){var t=O()(j.a.mark((function t(){var e,o,n,s,r,c,a;return j.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e="/v1/couponapisrv/campaign/promo_codes/info?coupon_codes=".concat(this.couponCode),t.prev=1,t.next=4,this.$axios.get(e);case 4:o=t.sent,n=o.data,s=n.success,r=n.error,c=n.result,s&&(this.card=null===c||void 0===c?void 0:c[0],this.showCard=!0),(null===r||void 0===r?void 0:r.code)&&(a=R(R({},r),{},{errorComponent:"discount-code",errorRequest:e}),console.log(a)),t.next=16;break;case 13:throw t.prev=13,t.t0=t.catch(1),new Error(t.t0);case 16:case"end":return t.stop()}}),t,this,[[1,13]])})));return function(){return t.apply(this,arguments)}}()},{key:"mounted",value:function(){var t=O()(j.a.mark((function t(){var e,o;return j.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return o=document.getElementsByClassName("layout_main")[0],null===(e=null===o||void 0===o?void 0:o.style)||void 0===e||e.setProperty("transform",""),t.next=4,this.getDiscountCodesByCodes();case 4:this.handleInited();case 5:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}()},{key:"loggedStatusChange",value:function(t){1===t&&this.redeem(this.card.code)}}]),o}(Object(m.mixins)(S.a));Object(f.a)([Object(m.Prop)({})],A.prototype,"slug",void 0),Object(f.a)([m.State],A.prototype,"klook",void 0),Object(f.a)([x.State],A.prototype,"isLoggedIn",void 0),Object(f.a)([x.State],A.prototype,"loggedStatus",void 0),Object(f.a)([Object(m.Watch)("loggedStatus")],A.prototype,"loggedStatusChange",null);var D=A=Object(f.a)([m.Component],A);function K(t){var e=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var o,n=p()(t);if(e){var s=p()(this).constructor;o=Reflect.construct(n,arguments,s)}else o=n.apply(this,arguments);return l()(this,o)}}var L=function(t){i()(o,t);var e=K(o);function o(){return s()(this,o),e.apply(this,arguments)}return c()(o)}(D),E=L=Object(f.a)([Object(m.Component)({components:{discountCard:b}})],L),I=(o("CjO8QH"),Object(y.a)(E,(function(){var t=this,e=t.$createElement,o=t._self._c||e;return t.visible&&t.card?o("div",{staticClass:"desktop-coupon-pop"},[o("div",{staticClass:"title-wrapper"},[t._v(t._s(t.$t(t.couponTitle)))]),t._v(" "),o("klk-icon",{staticClass:"close-icon",attrs:{type:"icon_navigation_close_m","data-spm-module":"CloseBtn","data-spm-virtual-item":"__virtual"},on:{click:t.closeModal}}),t._v(" "),o("div",{staticClass:"coupon-card"},[t.showCard?o("discount-card",{staticClass:"discount-wrapper",attrs:{card:t.card,"color-category":"oringe","color-type":2,"is-mobile":t.isMobile,page:t.$attrs.page}}):o("div",{staticClass:"coupon-feedback"},[t._v(" "+t._s(t.feedbackMessage))]),t._v(" "),o("div",{staticClass:"bottom-wrapper"},[o("klk-button",{staticClass:"login-btn",attrs:{type:"primary",reverse:"","data-spm-module":t.codeRedeemSpm,"data-spm-virtual-item":"__virtual"},on:{click:t.handleByStatus}},[t._v("\n        "+t._s(t.$t(t.footerBtnByStatus))+"\n      ")])],1)],1)],1):t._e()}),[],!1,null,"7f880536",null).exports);function H(t){var e=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var o,n=p()(t);if(e){var s=p()(this).constructor;o=Reflect.construct(n,arguments,s)}else o=n.apply(this,arguments);return l()(this,o)}}var J=function(t){i()(o,t);var e=H(o);function o(){return s()(this,o),e.apply(this,arguments)}return c()(o)}(D),G=J=Object(f.a)([Object(m.Component)({components:{discountCard:b}})],J),V=(o("hBdr71"),Object(y.a)(G,(function(){var t=this,e=t.$createElement,o=t._self._c||e;return t.card?o("klk-bottom-sheet",{staticClass:"coupon-bottom-sheet",attrs:{visible:t.visible,"mask-closable":!0,"show-close":""},on:{"update:visible":function(e){t.visible=e},close:t.closeByMobile}},[o("div",{staticClass:"coupon-content"},[o("div",{staticClass:"coupon-title"},[t._v(t._s(t.$t(t.couponTitle)))]),t._v(" "),o("div",{staticClass:"coupon-card"},[t.showCard?o("discount-card",{staticClass:"discount-wrapper",attrs:{card:t.card,"color-category":"oringe","color-type":2,"is-mobile":t.isMobile,"is-language-cn":t.isLanguageCn}}):t._e(),t._v(" "),o("div",{staticClass:"coupon-feedback"},[t._v(" "+t._s(t.feedbackMessage))])],1),t._v(" "),o("klk-button",{staticClass:"login-btn",attrs:{type:"primary",reverse:"","data-spm-module":t.codeRedeemSpm,"data-spm-virtual-item":"__virtual",page:t.$attrs.page},on:{click:t.handleByStatus}},[t._v("\n      "+t._s(t.$t(t.footerBtnByStatus))+"\n    ")])],1)]):t._e()}),[],!1,null,"c03bd6fe",null).exports);function q(t){var e=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var o,n=p()(t);if(e){var s=p()(this).constructor;o=Reflect.construct(n,arguments,s)}else o=n.apply(this,arguments);return l()(this,o)}}var U=Object(m.namespace)("auth"),W=Object(w.a)(),Y=function(t){i()(o,t);var e=q(o);function o(){var t;return s()(this,o),(t=e.apply(this,arguments)).storageKey="KLOOK-BLOG-COUPON",t.visible=!1,t}return c()(o,[{key:"mounted",value:function(){var t=this;setTimeout((function(){t.isLoggedIn||W.getItem(t.storageKey)||(t.visible=!0)}),3e4)}}]),o}(m.Vue);Object(f.a)([Object(m.Prop)({default:""})],Y.prototype,"slug",void 0),Object(f.a)([m.State],Y.prototype,"klook",void 0),Object(f.a)([U.State],Y.prototype,"isLoggedIn",void 0);var Z=Y=Object(f.a)([Object(m.Component)({components:{desktopCouponPop:I,mobileCouponPop:V}})],Y),z=Object(y.a)(Z,(function(){var t=this,e=t.$createElement,o=t._self._c||e;return t.visible?o("div",{staticClass:"coupons-card",attrs:{"spm-data-module":"BlogArticleCouponPopUp"}},[o("client-only",["desktop"===t.klook.platform?o("desktop-coupon-pop",{attrs:{slug:t.slug}}):o("mobile-coupon-pop",{attrs:{slug:t.slug}})],1)],1):t._e()}),[],!1,null,"5b4b6099",null);e.default=z.exports},tRHt7y:function(t,e,o){}}]);